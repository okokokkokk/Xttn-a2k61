<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>XÃ©t tuyá»ƒn tÃ i nÄƒng</title>
  <link rel="website icon" type="png" href="logo-a2.png">
  <link rel="stylesheet" href="index.css">
</head>
<body>
  <div class="container">
    <div>
        <h2 class="tieude">Form xÃ©t tuyá»ƒn tÃ i nÄƒng vÃ o lá»›p A2K61</h2>
    </div>
    <label>Há» tÃªn <input type="text" id="hoten"></label>
    <label>Lá»›p <input type="text" id="loptruong"></label>


    <label>Äiá»ƒm tb cáº£ nÄƒm mÃ´n ToÃ¡n <input type="number" id="toan" step="0.1" min="0" max="10"></label>
    <label>Äiá»ƒm tb cáº£ nÄƒm mÃ´n LÃ½ <input type="number" id="ly" step="0.1" min="0" max="10"></label>
    <label>Äiá»ƒm tb cáº£ nÄƒm mÃ´n Anh <input type="number" id="anh" step="0.1" min="0" max="10"></label>

    <label>Sá»‘ giáº£i Khuyáº¿n khÃ­ch (kÃ¬ thi hsg) <input type="number" id="kk" min="0"></label>
    <label>Sá»‘ giáº£i Ba (kÃ¬ thi hsg) <input type="number" id="ba" min="0"></label>
    <label>Sá»‘ giáº£i NhÃ¬ (kÃ¬ thi hsg) <input type="number" id="nhi" min="0"></label>
    <label>Sá»‘ giáº£i Nháº¥t (kÃ¬ thi hsg) <input type="number" id="nhat" min="0"></label>

    <label>IELTS (náº¿u cÃ³)<input type="number" id="ielts" step="0.5" min="0" max="9"></label>
    <label>Há»c sinh lá»›p chá»n khÃ´ng?:
      <select id="lop">
        <option value="">-- Chá»n lá»›p --</option>
        <option value="A1K61">A1K61</option>
        <option value="A5K61">A5K61</option>
        <option value="D1K61">D1K61</option>
        <option value="D2K61">D2K61</option>
        <option value="KhÃ¡c">KhÃ´ng</option>
      </select>
    </label>
    
    
    <label>Äiá»ƒm phá»ng váº¥n (0â€“20) <input type="number" id="pv" min="0" max="20"></label>

    <button onclick="tinhDiem()">TÃ­nh Ä‘iá»ƒm</button>
    <button onclick="window.location.href='huongdan.html'">ğŸ“˜ HÆ°á»›ng dáº«n tÃ­nh Ä‘iá»ƒm</button>

    <div id="result"></div>
  </div>

  <script>
    function tinhDiem() {
      const toan = +document.getElementById('toan').value;
      const ly = +document.getElementById('ly').value;
      const anh = +document.getElementById('anh').value;
      const kk = +document.getElementById('kk').value;
      const ba = +document.getElementById('ba').value;
      const nhi = +document.getElementById('nhi').value;
      const nhat = +document.getElementById('nhat').value;
      const ielts = +document.getElementById('ielts').value;
      const pv = +document.getElementById('pv').value;
      const lop = document.getElementById('lop').value;

      const name = document.getElementById('hoten').value;
      const loptruong = document.getElementById('loptruong').value;

      const tb = (toan + ly + anh) / 3;
      const diemHocBa = tb * 4;
      const diemThanhTich = Math.min(30, kk * 5 + ba * 10 + nhi * 15 + nhat * 20);

      let diemIELTS = 0;
      if (ielts >= 5 && ielts <= 9) {
        diemIELTS = Math.floor((ielts - 5) * 2) + 1;
      }

      let diemLop = 0;
      if (lop === "A1K61" || lop === "D1K61") diemLop = 5;
      else if (lop === "A5K61" || lop === "D2K61") diemLop = 4;

      const tongGiai = kk + ba + nhi + nhat;
      let diemThuong = diemIELTS + diemLop + (tongGiai >= 2 ? 2 : 0);
      diemThuong = Math.min(10, diemThuong);

      const tong = diemHocBa + diemThanhTich + diemThuong + pv;

      const resultDiv = document.getElementById('result');
      const status = tong >= 50 ? "Äá»–" : "KHÃ”NG Äá»–";

      if (tong >= 50) {
        resultDiv.innerHTML = `âœ… <b>Äá»–! ChÃºc má»«ng báº¡n Ä‘Ã£ Ä‘á»— xttn vÃ o lá»›p A2K61</b> â€” Tá»•ng Ä‘iá»ƒm: <b>${tong.toFixed(1)}</b>`;
        resultDiv.className = 'passed';
      } else {
        resultDiv.innerHTML = `âŒ <b>KHÃ”NG Äá»–! ChÃºc báº¡n may máº¯n láº§n sau</b> â€” Tá»•ng Ä‘iá»ƒm: <b>${tong.toFixed(1)}</b>`;
        resultDiv.className = 'failed';
      }

      // Gá»­i dá»¯ liá»‡u lÃªn Google Sheets
      fetch("https://script.google.com/macros/s/AKfycbz4jwImlxSfaljOxC7TFvOT7uu9MkfQm4kimdQhVXQhX4cJluNxPqXRksHzZgWXix-Qlg/exec", {
        method: "POST",
        body: JSON.stringify({
          name: name,
          class: loptruong,
          score: tong.toFixed(1),
          status: status
        }),
        headers: {
          "Content-Type": "application/json"
        }
      });
    }

    
    function hienHuongDan() {
      alert(`ğŸ¯ QUY Táº®C TÃNH ÄIá»‚M:
      1. ğŸ”¢ Äiá»ƒm há»c báº¡:
        - Trung bÃ¬nh 3 mÃ´n ToÃ¡n, LÃ½, Anh
        - CÃ´ng thá»©c : Äiá»ƒm há»c báº¡ = (((ToÃ¡n + LÃ½ + Anh) / 3) / 10) * 40
        â¤ Tá»‘i Ä‘a: 40 Ä‘iá»ƒm

      2. ğŸ† ThÃ nh tÃ­ch há»c sinh giá»i:
        - Khuyáº¿n khÃ­ch: 5 Ä‘iá»ƒm
        - Giáº£i Ba: 10 Ä‘iá»ƒm
        - Giáº£i NhÃ¬: 15 Ä‘iá»ƒm
        - Giáº£i Nháº¥t: 20 Ä‘iá»ƒm
        (Nhiá»u giáº£i cÃ³ thá»ƒ cá»™ng dá»“n náº¿u sá»‘ Ä‘iá»ƒm > 30Ä‘ thÃ¬ láº¥y 30Ä‘)
        â¤ Tá»‘i Ä‘a: 30 Ä‘iá»ƒm

      ...
      3. ğŸ–ï¸ Äiá»ƒm thÆ°á»Ÿng:
        - IELTS 5.0 trá»Ÿ lÃªn: 1â€“5 Ä‘iá»ƒm
        - CÃ³ tá»« 2 giáº£i trá»Ÿ lÃªn: +2 Ä‘iá»ƒm
        - Há»c sinh cÃ¡c lá»›p:
          + A1K61, D1K61: +5 Ä‘iá»ƒm
          + A5K61, D2K61: +4 Ä‘iá»ƒm
          + KhÃ¡c: KhÃ´ng Ä‘Æ°á»£c cá»™ng Ä‘iá»ƒm
        â¤ Tá»‘i Ä‘a pháº§n thÆ°á»Ÿng: 10 Ä‘iá»ƒm
      ...
      4. ğŸ’¬ Phá»ng váº¥n:
        â¤ Tá»‘i Ä‘a: 20 Ä‘iá»ƒm

      ğŸ“ Tá»•ng Ä‘iá»ƒm tá»‘i Ä‘a: 100
      âœ… Tá»« 50 Ä‘iá»ƒm trá»Ÿ lÃªn: Äá»–
      âŒ DÆ°á»›i 50 Ä‘iá»ƒm: KHÃ”NG Äá»–`);
    }

  </script>
</body>
</html>
